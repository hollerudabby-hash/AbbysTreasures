// ===== ADMIN PASSWORD PROTECTION =====
const ADMIN_PASSWORD = "Unicorns123$$"; 

window.addEventListener("DOMContentLoaded", () => {
  let attempt = prompt("Enter admin password to access this page:");

  if(attempt === ADMIN_PASSWORD){
    document.getElementById("admin-products").style.display = "block";
    alert("Welcome, Admin!");
  } else {
    alert("Incorrect password! You will not be able to access this page.");
    document.body.innerHTML = "<h2>Access Denied</h2>";
  }
});

// ===== SHOP PRODUCTS =====
let shopProducts = [
  { name: "Pink Sparkle Sticker", stock: 5, price: 4.99, paypalLink: "https://www.paypal.com/pay?token=YOUR-PAYPAL-LINK1" },
  { name: "Cozy Journal", stock: 3, price: 12.99, paypalLink: "https://www.paypal.com/pay?token=YOUR-PAYPAL-LINK2" }
  // Add more products here as needed
];

// ===== UPDATE STOCK FUNCTION =====
function updateStock(index) {
  const adminProductDivs = document.querySelectorAll(".admin-product");
  const input = adminProductDivs[index].querySelector(".new-stock");
  const newStock = parseInt(input.value);

  if (isNaN(newStock) || newStock < 0) {
    alert("Please enter a valid stock number!");
    return;
  }

  shopProducts[index].stock = newStock;
  adminProductDivs[index].querySelector(".current-stock").textContent = newStock;

  // Update main shop page if open
  if (window.opener) {
    const mainProducts = window.opener.document.querySelectorAll(".product");
    const stockEl = mainProducts[index].querySelector(".stock");
    const button = mainProducts[index].querySelector("button");
    const soldOutNote = mainProducts[index].querySelector(".sold-out-note");

    stockEl.dataset.stock = newStock;
    stockEl.textContent = newStock > 0 ? "In stock: " + newStock : "Sold Out";

    if(newStock === 0){
      button.disabled = true;
      button.textContent = "Sold Out";
      button.style.backgroundColor = "#ccc";
      soldOutNote.textContent = "This item is permanently retired â€” no restocks.";
      mainProducts[index].style.opacity = 0.7;
    } else {
      button.disabled = false;
      button.textContent = "Add to Cart";
      button.style.backgroundColor = "#c45a8d";
      soldOutNote.textContent = "";
      mainProducts[index].style.opacity = 1;
    }
  }

  input.value = "";
  alert(`Stock for ${shopProducts[index].name} updated to ${newStock}`);
}